# Claudeに考えさせる（思考連鎖プロンプト）でパフォーマンスを向上させる

---

<Note>
While these tips apply broadly to all Claude models, you can find prompting tips specific to extended thinking models [here](/docs/en/build-with-claude/prompt-engineering/extended-thinking-tips).
</Note>

研究、分析、問題解決などの複雑なタスクに直面した際、Claudeに考える余地を与えることでパフォーマンスを大幅に向上させることができます。思考連鎖（CoT）プロンプティングとして知られるこの手法は、Claudeに問題を段階的に分解することを促し、より正確で細やかな出力につながります。

## CoTを実装する前に

### なぜClaudeに考えさせるのか？
- **正確性：** 問題を段階的に進めることで、特に数学、論理、分析、または一般的に複雑なタスクでのエラーを減らすことができます。
- **一貫性：** 構造化された思考により、より結束力のある、よく整理された回答が得られます。
- **デバッグ：** Claudeの思考プロセスを見ることで、プロンプトが不明確な箇所を特定するのに役立ちます。

### なぜClaudeに考えさせない方がよい場合があるのか？
- 出力の長さが増えることでレイテンシーに影響を与える可能性があります。
- すべてのタスクが深い思考を必要とするわけではありません。パフォーマンスとレイテンシーの適切なバランスを確保するために、CoTを適切に使用してください。

<Tip>複雑な数学、多段階の分析、複雑な文書の作成、多くの要因を含む決定など、人間が考える必要があるようなタスクにCoTを使用してください。</Tip>

***

## 思考を促すプロンプトの方法

以下の思考連鎖テクニックは**単純なものから複雑なものの順に**並べられています。より単純な方法はコンテキストウィンドウの使用スペースが少なくなりますが、一般的に機能も限定的です。

<Tip>**CoTのヒント**：必ずClaudeに思考プロセスを出力させてください。思考プロセスを出力しなければ、思考は行われません！</Tip>

- **基本的なプロンプト**：プロンプトに「段階的に考えてください」を含めます。
    - *どのように*考えるかについてのガイダンスが不足しています（特にタスクがアプリ、ユースケース、組織に特有の場合は理想的ではありません）
    <section title="例：寄付者へのメール作成（基本的なCoT）">

        | 役割 | 内容 |
        | ---- | --- |
        | ユーザー | 今年のCare for Kidsプログラムへの寄付を依頼する、寄付者向けのパーソナライズされたメールを作成してください。<br/><br/>プログラム情報：<br/>\\{\{PROGRAM_DETAILS}}<br/>\</program><br/><br/>寄付者情報：<br/>\<donor>\{\{DONOR_DETAILS}}<br/>\</donor><br/><br/>メールを書く前に段階的に考えてください。 |
    
</section>
- **ガイド付きプロンプト**：Claudeが従うべき具体的な思考ステップを概説します。
    - 回答と思考を分離して抽出しやすくする構造化が不足しています。
    <section title="例：寄付者へのメール作成（ガイド付きCoT）">

        | 役割 | 内容 |
        | ---- | --- |
        | ユーザー | 今年のCare for Kidsプログラムへの寄付を依頼する、寄付者向けのパーソナライズされたメールを作成してください。<br/><br/>プログラム情報：<br/>\\{\{PROGRAM_DETAILS}}<br/>\</program><br/><br/>寄付者情報：<br/>\<donor>\{\{DONOR_DETAILS}}<br/>\</donor><br/><br/>メールを書く前に考えてください。まず、寄付履歴と過去に支援したキャンペーンを考慮して、この寄付者にどのようなメッセージが効果的か考えてください。次に、その履歴を踏まえて、Care for Kidsプログラムのどの側面が彼らに訴求するか考えてください。最後に、あなたの分析を用いてパーソナライズされた寄付者向けメールを作成してください。 |
    
</section>
- **構造化プロンプト**：`<thinking>`や`<answer>`などのXMLタグを使用して、推論と最終的な回答を分離します。
     <section title="例：寄付者へのメール作成（構造化ガイド付きCoT）">

        | 役割 | 内容 |
        | ---- | --- |
        | ユーザー | 今年のCare for Kidsプログラムへの寄付を依頼する、寄付者向けのパーソナライズされたメールを作成してください。<br/><br/>プログラム情報：<br/>\\{\{PROGRAM_DETAILS}}<br/>\</program><br/><br/>寄付者情報：<br/>\<donor>\{\{DONOR_DETAILS}}<br/>\</donor><br/><br/>\<thinking>タグ内でメールを書く前に考えてください。まず、寄付履歴と過去に支援したキャンペーンを考慮して、この寄付者にどのようなメッセージが効果的か考えてください。次に、その履歴を踏まえて、Care for Kidsプログラムのどの側面が彼らに訴求するか考えてください。最後に、\<email>タグ内で、あなたの分析を用いてパーソナライズされた寄付者向けメールを作成してください。 |
    
</section>
    
### 例

  <section title="例：思考なしの財務分析">

    段階的な思考がない場合、Claudeは一見合理的な推奨を提供しますが、深みに欠けます。潜在的な結果を定量化したり、過去の市場パフォーマンスを考慮したりしていません。これらは十分な情報に基づいた決定を下すために重要です。
    | 役割 | 内容 |
    | ---- | --- |
    | ユーザー | あなたはファイナンシャルアドバイザーです。クライアントが10,000ドルを投資したいと考えています。2つの選択肢があります：A）過去に年間12%のリターンがあるが変動の大きい株式、またはB）年間6%を保証する債券。クライアントは5年後に住宅の頭金として資金が必要です。どちらの選択肢を推奨しますか？ |
    | アシスタント | 提供された情報に基づいて、オプションB、年間6%の保証リターンを提供する債券を推奨します。理由は以下の通りです：<br/><br/>1. 確実性：債券は年間6%の保証リターンを提供し、財務計画に確実性をもたらします。これは、クライアントが特定の財務目標（頭金）と固定の期間（5年）を持っている場合に重要です。<br/>2. リスク回避：クライアントはこの資金を重要なライフイベント（住宅購入）に必要としているため、リスク許容度は低いと考えられます。株式市場の変動性は、資金が必要な時期に近い時期に下落が起きた場合、計画を危うくする可能性があります。<br/>3. 投資期間：わずか5年では、株式市場の下落から回復する時間が限られています。より長期の投資期間（10年以上）の方が、株式市場の変動性に対応するのに適しています。<br/><br/>株式の過去12%のリターンは魅力的ですが、過去のパフォーマンスは将来の結果を保証するものではありません。債券からの保証された6%により、頭金を支払う時期に必要な資金を確実に確保できます。 |
  
</section>
  <section title="例：思考を伴う財務分析">

    段階的な思考により、アドバイザーはより充実した分析を提供します。両方のシナリオの正確な数値を計算し、過去の市場の変動性を考慮し、クライアントのリスク許容度を深く分析します。この徹底的な推論により、より確信を持って正当化できる推奨につながります。
    | 役割 | 内容 |
    | ---- | --- |
    | ユーザー | あなたはファイナンシャルアドバイザーです。クライアントが10,000ドルを投資したいと考えています。2つの選択肢があります：A）過去に年間12%のリターンがあるが変動の大きい株式、またはB）年間6%を保証する債券。クライアントは5年後に住宅の頭金として資金が必要です。どちらの選択肢を推奨しますか？段階的に考えてください。 |
    | アシスタント | クライアントに最適な投資オプションを決定するために、以下の要因を段階的に検討します：<br/><br/>\<thinking><br/>1. クライアントの目標と期間を理解する：<br/>   - 目標：住宅の頭金<br/>   - 期間：5年<br/>   - 意味：これは短期的で優先度の高い財務目標です。クライアントは大きなリスクや変動性を許容できない可能性が高い。<br/><br/>2. オプションA（株式）の分析：<br/>   - 長所：より高い過去のリターン（年間12%）<br/>   - 短所：変動性（大きな利益または損失の可能性を意味）<br/>   - 5年間のリターンを計算：<br/>     - 最良のケース（年間12%）：10,000ドル * (1.12)^5 ≈ 17,623.42ドル<br/>     - 最悪のケース（市場暴落）：かなりの部分を失う可能性、例：50%の暴落 = 5,000ドル<br/><br/>3. オプションB（債券）の分析：<br/>   - 長所：保証されたリターン（年間6%）<br/>   - 短所：過去の株式パフォーマンスと比較して低いリターン<br/>   - 5年間のリターンを計算：<br/>     - 保証：10,000ドル * (1.06)^5 ≈ 13,382.25ドル<br/><br/>4. リスク許容度の考慮：<br/>   - 目標は住宅の頭金（裁量的ではなく必須）<br/>   - 短期間（5年）は市場下落からの回復能力を制限<br/>   - 結論：クライアントはリスク許容度が低い可能性が高い<br/><br/>5. 歴史的な観点：<br/>   - 株式の12%は過去の実績であり、保証されていない<br/>   - 5年間の期間で、株式市場は大きく変動する可能性：<br/>     - 2003-2007年（金融危機前）：S&P 500は約82%上昇<br/>     - 2007-2011年（危機中）：S&P 500は約2%下落<br/>   - 結論：過去のパフォーマンスは、特に短期的には将来の結果を保証しない<br/><br/>6. 最終分析：<br/>   - オプションA（株式）：より高い潜在的リターンだが、頭金の目標を達成できないリスクが許容できない<br/>   - オプションB（債券）：株式の最良のケースの約80%を保証し、資金の100%確実性がある<br/>\</thinking><br/><br/>\<answer><br/>年間6%の保証リターンを提供する債券、オプションBを推奨します。株式の過去12%のリターンは魅力的ですが、債券は5年後に13,382.25ドルを確実に提供します。目標の重要性と短期間を考慮すると、株式の変動性は許容できないリスクとなります。債券は確実性を提供し、これは重要な財務的マイルストーンにとって非常に価値があります。<br/>\</answer> |
  
</section>

***

<CardGroup cols={3}>
  <Card title="プロンプトライブラリ" icon="link" href="/docs/ja/resources/prompt-library/library">
    様々なタスクやユースケースのために厳選されたプロンプトで、アイデアを得ましょう。
  </Card>
  <Card title="GitHubプロンプティングチュートリアル" icon="link" href="https://github.com/anthropics/prompt-eng-interactive-tutorial">
    当社のドキュメントに記載されているプロンプトエンジニアリングの概念を網羅した、例が豊富なチュートリアルです。
  </Card>
  <Card title="Google Sheetsプロンプティングチュートリアル" icon="link" href="https://docs.google.com/spreadsheets/d/19jzLgRruG9kjUQNKtCg1ZjdD6l6weA6qRXG5zLIAhC8">
    インタラクティブなスプレッドシートを通じた、より軽量版のプロンプトエンジニアリングチュートリアルです。
  </Card>
</CardGroup>