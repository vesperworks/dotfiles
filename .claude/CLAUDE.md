# 最重要ルール - 新しいルールの追加プロセス

ユーザーから今回限りではなく常に対応が必要だと思われる指示を受けた場合：

1. 「これを標準のルールにしますか？」と質問する
2. YESの回答を得た場合、CLAUDE.mdに追加ルールとして記載する
3. 以降は標準ルールとして常に適用する

このプロセスにより、プロジェクトのルールを継続的に改善していきます。

## 提案時のルール

提案を求められた時は、推奨確率を添えて最低3パターン提案してください。

## コーディング原則
- YAGNI（You Aren't Gonna Need It）：今必要じゃない機能は作らない
- DRY（Don't Repeat Yourself）：同じコードを繰り返さない
- KISS（Keep It Simple Stupid）：シンプルに保つ
- SOLID：オブジェクト指向設計の5原則を守る（単一責任・オープン/クローズド・リスコフの置換・インターフェース分離・依存性逆転）


## 推奨コマンド
- rg
- ni
- nr 

NEVER: Path Traversal
NEVER: Command Injection
NEVER: XSS (Cross-Site Scripting)

## 基本原則                                                                                                         
- Explore -> Plan -> Confirm -> Code -> Commit
- **推論の制限**: 記載されていない内容や不明な点について推測せず、必ずユーザーに確認する
- **エスカレーション**: 3回連続で問題に行き詰まった場合は、ユーザーに指示を仰ぐ
- **対話言語**: 日本語でコミュニケーションを行う
- 現在の作業が明確でない場合は、どんなアプリを作りたいのか、要件定義を僕にヒアリングをしてください。

## 技術実装の方針                                                                                                   
 **公式ドキュメント優先**: ライブラリやフレームワークを使用する際は、最新の公式ドキュメントを必ず参照する
 **設計思想の理解**: 使用する技術の設計思想を理解し、その作法に従って実装を提案する
 **既存コードとの整合性**: プロジェクト内の既存のコーディング規約やパターンに従う

## Gemini Search
`gemini` は google gemini cliです。あなたはWeb検索でこのツールを使えます。
Run web search via Task Tool with `gemini -p 'WebSearch: ...'`.
'echo ...で検索中'も一緒に実行してください。

## commit規則
- authorを2度と書くな。setting.jsonにも書いてある。

### 📝 コードレビュー基準

## 可読性・保守性
- **変数名**: 目的が明確にわかること（`data`ではなく`userProfiles`）
- **関数の責任**: 1つの関数は1つの責任のみを持つ
- **ネスト制限**: ネストは3レベル以下に抑える
- **コメント**: 「なぜ」を説明する（「何を」ではなく）

## セキュリティ
- **入力検証**: ユーザー入力は必ずサニタイズ・バリデーション
- **SQLインジェクション対策**: パラメータ化クエリ使用
- **機密情報管理**: 環境変数で管理、ログに出力禁止
- **禁止事項**: eval()使用禁止、パスワードハードコーディング禁止

## パフォーマンス
- **データベース**: N+1クエリの発生チェック
- **メモリ管理**: イベントリスナーの適切な削除
- **大量データ**: ページネーションの実装

## エラーハンドリング
- **API呼び出し**: すべてのAPI呼び出しでエラーハンドリング実装
- **ユーザー体験**: ユーザーフレンドリーなエラーメッセージ
- **ログ管理**: 適切なログレベル設定（ERROR, WARN, INFO）

## レビュー優先度
- **CRITICAL**: セキュリティ、データ損失リスク
- **HIGH**: パフォーマンス、保守性
- **MEDIUM**: 可読性、一貫性
- **LOW**: スタイル、コメント
- LOG.mdとして書くようにまとめて。\
プロジェクトのCALUDE.mdには今調べてくれたものを書くように。\
作業履歴はLOG.mdに記録。削除も完了もここ。
PRPsのファイル管理は、単純に終わったPRPファイルをどうするかというルール\
