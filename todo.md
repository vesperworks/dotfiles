# TODO: マルチエージェントワークフロー実装の残タスク

更新日: 2025-06-24（修正フェーズ2完了をdone.mdへアーカイブ）

## 📝 修正フェーズ3: 検証とテスト（次のステップ）

### 修正完了の検証手順
- [ ] **テスト1**: 日本語パラメータでのworktree作成テスト
- [ ] **テスト2**: 各フェーズの順次実行テスト（Analysis→Plan→Refactor→Verify）
- [ ] **テスト3**: エラー発生時の適切な処理テスト（rollback動作確認）
- [ ] **テスト4**: 最終的なリファクタリング完了テスト（実際のコード整理）

## 🔴 未実装項目（CLAUDE.md記載内容との差分）

### Scripts整備
- [ ] CLAUDE.mdのプロジェクト構造に記載なし → CLAUDE.mdの更新が必要

### 各ワークフローの自動テストスクリプト作成
- [ ] 各ワークフローの自動テストスクリプト作成

### TDDサイクルの並列化による効率化（将来拡張）
- [ ] Testerエージェントの早期投入
  - [ ] 各TDDサイクル完了後に即座にTesterを起動
  - [ ] Coderの次サイクルとTesterの検証を並列実行
- [ ] MCP連携の専門化
  - [ ] MCP-Testerサブエージェント（Playwright/Puppeteer専門）
  - [ ] E2Eテストの自動生成・実行を並列化
- [ ] 効果測定（運用後実施予定）
  - [ ] TDDサイクル時間の短縮率を計測（目標：30-40%短縮）
  - [ ] 早期品質問題発見率の向上

### 並列TDD機能のコマンド統合
- [ ] multi-tdd.mdに`--parallel`オプションを追加
- [ ] オプション指定時に`run_parallel_agents()`を呼び出す
- [ ] デフォルトは従来の順次実行を維持
- [ ] 使用例とパフォーマンス比較をドキュメント化

### MCP連携機能の実装
- [ ] Context7連携の具体的な実装
- [ ] Playwright/Puppeteer統合のサンプル作成
- [ ] MCP設定ドキュメントの作成

## 🟡 推奨改善項目

### ドキュメント整備
- [ ] トラブルシューティングガイド
- [ ] ベストプラクティス集

### エラーハンドリング強化
- [ ] worktree作成失敗時のリトライ機能
- [ ] ネットワークエラー時の対処
- [ ] 不完全なタスクのリカバリー機能

### 監視・ログ機能
- [ ] タスク実行履歴の記録
- [ ] パフォーマンスメトリクスの収集
- [ ] 成功/失敗率の可視化

### 設定のカスタマイズ
- [ ] `.claude/config.json` - ユーザー設定ファイル
- [ ] タイムアウト値の調整機能
- [ ] デフォルトブランチ名のカスタマイズ

## 📅 優先順位

### 📝 進行中タスク
1. **高**: 修正フェーズ3の検証とテスト
2. **高**: 並列TDD機能のコマンド統合

### 📈 今後の優先順位
1. **高**: 並列TDD機能のコマンド統合（ユーザーが使える状態にする）
2. **中**: 各ワークフローの自動テストスクリプト作成
3. **低**: MCP連携機能の実装（別フェーズでも可）
4. **低**: 推奨改善項目（運用開始後に順次対応）

## 💡 次のアクション

### 🔧 実施予定項目
1. **検証テスト** - 修正フェーズ3の検証と統合テスト
2. **並列TDDオプション** - multi-tdd.mdに`--parallel`オプションを追加
3. **ドキュメント更新** - 修正内容の反映と使用方法の更新

### 🎯 従来の次のアクション
1. **並列TDD機能のコマンド統合** - multi-tdd.mdに`--parallel`オプションを追加
2. 各ワークフローの自動テストスクリプト作成
3. MCP連携機能の実装検討
4. エラーハンドリング強化（リトライ機能など）

## ✅ multi-refactorバグ修正（修正フェーズ2完了）

修正フェーズ2のすべての修正が完了しました。詳細はdone.mdを参照してください。

## 🔧 期待される効果
- **モジュール化**: 並列実行機能の独立管理
- **再利用性**: 他プロジェクトでの活用可能
- **保守性**: 機能別の責任分離により修正が容易
- **拡張性**: 新しいエージェントタイプの追加が容易

## 🌟 multi-feature.md改善項目（Anthropicプロンプト分析から）

### 高優先度改善
- [ ] **XMLタグ構造の導入**
  - [ ] `<feature_development_workflow>`でワークフロー全体を囲む
  - [ ] 各フェーズを`<phase name="explore">`等でマークアップ
  - [ ] `<objectives>`, `<tools>`, `<output>`で各フェーズ内容を構造化
  - [ ] `<quality_gates>`で品質基準を明確化

- [ ] **強調語の体系的使用**
  - [ ] `ALWAYS`: 必須のコミット、テスト実行に使用
  - [ ] `NEVER`: 未テストのコミット、main直接編集の禁止に使用
  - [ ] `MUST`: ファイル作成前の確認、品質ゲート通過に使用
  - [ ] `IMPORTANT`: 重要な注意事項に限定使用

### 中優先度改善
- [ ] **番号付きリストによる段階的指示**
  - [ ] 各フェーズ内のステップを番号付きリストに変更
  - [ ] サブステップは箇条書きで整理
  - [ ] ステップ名をボールド体で強調

- [ ] **具体例の追加**
  - [ ] 各ワークフローに実行例を3つ以上追加
  - [ ] feature開発の具体例（認証、決済、通知など）
  - [ ] 期待される成果物の例を明示

- [ ] **数値制限の明示**
  - [ ] 最大ファイル数/フェーズ: 10
  - [ ] 最大コミット数/フェーズ: 5
  - [ ] タイムアウト/フェーズ: 15分
  - [ ] 最小テストカバレッジ: 80%

### 低優先度改善
- [ ] **簡潔性の向上**
  - [ ] 冗長な説明を削除
  - [ ] コマンド例をコードブロックで簡潔に
  - [ ] 「情報密度を高く、言葉数は最小に」の原則適用

- [ ] **条件分岐の明示的処理**
  - [ ] 「For depth-first features:」形式で条件別対応を記載
  - [ ] 「For breadth-first features:」で並列開発可能な機能を区別
  - [ ] 「For straightforward features:」で単純な機能開発を効率化

- [ ] **エラーハンドリングとフォールバック**
  - [ ] 各フェーズのエラー時の具体的対処法
  - [ ] 競合解決のための手順
  - [ ] ロールバック手順の明確化

### 実装順序
1. **第1段階**: XMLタグ構造と強調語の導入（構造的改善）
2. **第2段階**: 番号付きリストと具体例の追加（理解促進）
3. **第3段階**: 数値制限と品質ゲートの明示（品質保証）
4. **第4段階**: 簡潔性向上と条件分岐処理（最適化）